{% extends "network/layout.html" %}

{% block body %}
<div class="userdetails"> 
    <img src=" {{ profile.image }}" class="profilepicture"> 
    <h2> {{ profile.username}} </h2>
    <div class="count">
        <h3 class="followcount"> <b>{{ followers }}</b> followers </h3>
        <h3 class="followcount"> <b>{{ following }}</b> following </h3>
        <h3 class="followcount"> <b>{{ postcount }}</b> posts </h3>
    </div>

    {% if user.is_authenticated and thisuser == False %}
        {% if check == True %}
            <form class="followform" method="POST" action="{% url 'updatefollow' profile.username %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-secondary btn-lg" style="margin:auto;">Unfollow</button>
            </form>
        {% else %}
        <form class="followform" method="POST" action="{% url 'updatefollow' profile.username %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-secondary btn-lg" style="margin:auto;">Follow</button>
        </form>
        {% endif %}
    {% endif %}
</div>
    {% if user.is_authenticated %}
        {% for post in page_obj %}
            <div class="post">
                <div style="margin:auto;">
                    <img src="{{ post.user.image }}" class="profilepicture">
                </div>
                <div>
                <p class="thevalue" style="display:none" data-value="{{ post.id }}">{{ post.id }}</p>
                <a href="{% url 'userprofile' post.user %}" class="userlink" ><p class="userlink" >{{ post.user }}</p></a>
                <div style="display:block" id="content">
                    <p class="content">{{ post.content }}</p>
                </div>
                <div style="display:none" id="edittext">
                    <input class="form-control edittext" id="exampleFormControlTextarea1" rows="3" name="content">
                    <button type="submit" class="btn btn-secondary btn-sm save" >Save</button>
                </div>
                <p {% if post.id in likes %}
                        {class="likecount"><i id="heart" class='fa fa-heart red-color'}
                    {% else %}
                        {class="likecount"><i id="heart" class='fa fa-heart-o' aria-hidden="true"}
                    {% endif %} 
                ></i> <span class="counting"> {{ post.count }} </span> </p>
                <p class="postdate">{{ post.date }}</p>
                {% if post.user == user %}
                    <button type="submit" class="btn btn-secondary btn-sm edit">Edit</button>
                {% endif %}
            </div>
        </div>
        {% endfor %}
        <div class="pagination">
            <span class="pagination">
                {% if page_obj.has_previous %}
                    <a class="page-link" href="?page=1">&laquo; 1</a>
                    <a class="page-link" href="?page={{ page_obj.previous_page_number }}">previous</a>
                {% endif %}
        
                <span class="page-link">
                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                </span>
        
                {% if page_obj.has_next %}
                    <a class="page-link" href="?page={{ page_obj.next_page_number }}">next</a>
                    <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
                {% endif %}
            </span>
        </div>
    {% else %}
        <div class="container-lg">
            <h1 style="margin:auto"> Please log in to see posts</h1>
            <a style="margin:auto" href="{% url 'login' %}"><h3>Log in</h3></a>
        </div>
    {% endif %}
{% endblock %}